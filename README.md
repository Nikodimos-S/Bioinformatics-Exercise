# Bioinformatics Exercise
 
Δημιουργία Αλληλουχιών με Τυχαίες Μεταλλάξεις

Το πρώτο μέρος του κώδικα ασχολείται με τη δημιουργία τυχαίων αλληλουχιών που περιέχουν ελαφρές μεταλλάξεις. Ξεκινά παίρνοντας προεπιλεγμένα μοτίβα DNA και τα μεταλλάσσει τυχαία. H συνάρτηση`random_mutation` είναι υπεύθυνη για αυτές τις αλλαγές. Τυχαία αποφασίζει πόσες μεταλλάξεις θα εισαγάγει (μεταξύ 0 και 2) και σε ποιες θέσεις της αλληλουχίας θα συμβούν. Οι μεταλλάξεις μπορούν είτε να αλλάξουν μια βάση DNA (π.χ., να αλλάξει το Α σε Τ) είτε να διαγράψουν τελείως μια βάση. Η τελική μεταλλαγμένη αλληλουχία επιστρέφεται.

Μια άλλη συνάρτηση, `generate_sequence`, παίρνει αυτά τα μεταλλαγμένα μοτίβα και τα ενώνει για να δημιουργήσει μεγαλύτερες αλληλουχίες. Ξεκινά με ένα τυχαίο string 1 έως 3 βάσεων DNA, στη συνέχεια προσθέτει τα μεταλλαγμένα μοτίβα ένα-ένα και τελειώνει με ένα ακόμη τυχαίο string 1 έως 2 βάσεων. Αυτή η διαδικασία επαναλαμβάνεται 50 φορές για να δημιουργηθούν 50 μοναδικές αλληλουχίες. Τέλος, οι πρώτες 15 αλληλουχίες αποτελούν το datasetA ενώ οι υπόλοιπες 35 το datasetB.


Multiple Sequence Alignment (MSA)

Αφού δημιουργηθούν οι αλληλουχίες, αυτές ευθυγραμμίζονται χρησιμοποιώντας τον αλγόριθμο Needleman-Wunsch. Αυτή είναι μια κλασική τεχνική που χρησιμοποιείται για την ευθυγράμμιση δύο αλληλουχιών, βρίσκοντας την καλύτερη δυνατή αντιστοιχία μεταξύ τους και λαμβάνοντας υπόψη τα κενά και τις αταίριαστες βάσεις. Η ευθυγράμμιση ελέγχεται από μια παράμετρο που ονομάζεται `a`, η οποία ορίζεται με βάση τον αριθμό μητρώου μου ο οποίος είναι 21150. 

Ο αλγόριθμος Needleman-Wunsch λειτουργεί δημιουργώντας έναν πίνακα βαθμολογίας που αντιπροσωπεύει τις διάφορες πιθανές ευθυγραμμίσεις και στη συνέχεια trace back τον πίνακα για να βρει την βέλτιστη ευθυγράμμιση. Εξετάζει τρεις κύριες επιλογές σε κάθε βήμα: το match (ή την mismatch) δύο βάσεων, την εισαγωγή κενού σε μία αλληλουχία ή τη διαγραφή μιας βάσης. Το τελικό αποτέλεσμα είναι ένα ζεύγος ευθυγραμμισμένων αλληλουχιών με την υψηλότερη δυνατή βαθμολογία ευθυγράμμισης.

Για την ευθυγράμμιση όλων των αλληλουχιών στο dataset, χρησιμοποιείται μια διαδικασία που ονομάζεται progressive alignment. Ξεκινά με την πρώτη αλληλουχία και την ευθυγραμμίζει με κάθε επόμενη αλληλουχία, δημιουργώντας σταδιακά μια ευθυγράμμιση.






Hidden Markov Model (HMM)

Μετά την ευθυγράμμιση των αλληλουχιών, ο κώδικας προχωρά στην κατασκευή ενός HMM. Αυτό το μοντέλο καταγράφει τις στατιστικές ιδιότητες των ευθυγραμμισμένων αλληλουχιών και μπορεί να χρησιμοποιηθεί για την αξιολόγηση νέων αλληλουχιών. Το HMM κατασκευάζεται ορίζοντας ένα σύνολο καταστάσεων, καθεμία από τις οποίες αντιστοιχεί σε μια θέση στις ευθυγραμμισμένες αλληλουχίες, και υπολογίζοντας δύο τύπους πιθανοτήτων: τις πιθανότητες εκπομπής (η πιθανότητα εμφάνισης μιας συγκεκριμένης βάσης DNA σε μια δεδομένη θέση) και τις πιθανότητες μετάβασης (η πιθανότητα μετάβασης από μία θέση στην επόμενη).

Ο αλγόριθμος Viterbi χρησιμοποιείται στη συνέχεια για την εφαρμογή αυτού του HMM σε νέες αλληλουχίες. Βρίσκει την πιο πιθανή διαδρομή μέσω του μοντέλου για μια δεδομένη αλληλουχία. Ο αλγόριθμος επιστρέφει τόσο το μονοπάτι ευθυγράμμισης όσο και μια βαθμολογία που αντικατοπτρίζει τη συνολική εφαρμογή.

Τέλος, ο κώδικας αξιολογεί τις αλληλουχίες στο δεύτερο dataset (`datasetB`) συγκρίνοντάς τες με το προφίλ HMM που κατασκευάστηκε από το πρώτο dataset (`datasetA`). Αυτό οδηγεί σε ένα σύνολο βαθμολογιών ευθυγράμμισης που δείχνουν πόσο παρόμοιες είναι αυτές οι νέες αλληλουχίες με τα αρχικά μοτίβα.

Συνοπτικά, ο κώδικας δημιουργεί τυχαίες αλληλουχίες με μεταλλάξεις, τις ευθυγραμμίζει χρησιμοποιώντας τον αλγόριθμο Needleman-Wunsch και κατασκευάζει ένα HMM profile για να αξιολογήσει πόσο καλά ταιριάζουν οι νέες αλληλουχίες με τα καθιερωμένα πρότυπα.

Θα ήθελα επίσης να σημειώσω ότι χρησιμοποιώ μία κλάση από την βιβλιοθήκη collections της python ονόματι defaultdict, η οποία είναι επι της ουσίας ένα απολύτως συνηθισμενο dictionary το οποίο απλά παρέχει default τιμές για κλειδιά τα οποία δεν υπάρχουν με αποτέλεσμα να μην πρέπει να γίνεται έλεγχος για το αν υπάρχει ένα κλειδί, προτού αυτό διαγραφεί η επεξεργαστεί.
